# {{ ansible_managed }}
# ==============================================================================
# Logrotate Configuration for System Logs
# ==============================================================================
# Generated by: posix_hardening_logs role
# ==============================================================================

{% for log_file in posix_logs_syslog_files %}
{{ log_file }}
{% endfor %}
{
    {{ posix_logs_syslog_frequency }}
    rotate {{ posix_logs_syslog_rotate_count }}
{% if posix_logs_syslog_compress | bool %}
    compress
{% endif %}
{% if posix_logs_delaycompress | bool %}
    delaycompress
{% endif %}
{% if posix_logs_missingok | bool %}
    missingok
{% endif %}
{% if posix_logs_notifempty | bool %}
    notifempty
{% endif %}
{% if posix_logs_create | bool %}
    create {{ posix_logs_syslog_create_mode }} {{ posix_logs_syslog_create_owner }} {{ posix_logs_syslog_create_group }}
{% endif %}
    sharedscripts
    postrotate
        # Reload rsyslog or syslog-ng if running
        if [ -f /var/run/rsyslogd.pid ]; then
            /usr/lib/rsyslog/rsyslog-rotate
        fi
    endscript
}
