# {{ ansible_managed }}
# ==============================================================================
# Audit Daemon Configuration
# ==============================================================================
# Generated by: posix_hardening_audit role
# ==============================================================================

# Log file location
log_file = {{ posix_audit_log_file }}

# Log format (RAW or ENRICHED)
log_format = {{ posix_audit_log_format }}

# Log file permissions
log_group = {{ posix_audit_log_group }}

# Flush type (NONE, INCREMENTAL, INCREMENTAL_ASYNC, DATA, SYNC)
flush = {{ posix_audit_flush }}

# How many records to write before forcing flush
# freq = 50

# Maximum log file size in MB
max_log_file = {{ posix_audit_max_log_file }}

# Number of log files to keep
num_logs = {{ posix_audit_num_logs }}

# Action when max_log_file is reached
# IGNORE, SYSLOG, SUSPEND, ROTATE, KEEP_LOGS
max_log_file_action = {{ posix_audit_max_log_file_action }}

# Space left threshold in MB
space_left = {{ posix_audit_space_left }}

# Action when space_left threshold is reached
# IGNORE, SYSLOG, EMAIL, SUSPEND, SINGLE, HALT
space_left_action = {{ posix_audit_space_left_action }}

# Email notification (requires mail setup)
# action_mail_acct = root

# Admin space left threshold in MB
admin_space_left = {{ posix_audit_admin_space_left }}

# Action when admin_space_left threshold is reached
admin_space_left_action = {{ posix_audit_admin_space_left_action }}

# Action when disk is full
# IGNORE, SYSLOG, SUSPEND, SINGLE, HALT
disk_full_action = {{ posix_audit_disk_full_action }}

# Action when disk error occurs
# IGNORE, SYSLOG, SUSPEND, SINGLE, HALT
disk_error_action = {{ posix_audit_disk_error_action }}

# Use audit's built-in rate limiting
# rate = 0

# TCP settings (if using remote logging)
# tcp_listen_port = 60
# tcp_listen_queue = 5
# tcp_max_per_addr = 1
# tcp_client_ports = 1024-65535
# tcp_client_max_idle = 0

# Enable kernel auditing
# enable_krb5 = no

# Distribute messages among available CPUs
# distribute_network = no

# Priority boost for audit daemon
# priority_boost = 4

# Name format for node names
name_format = HOSTNAME
# name = mydomain
