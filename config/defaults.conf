# POSIX Shell Server Hardening Toolkit - Default Configuration
# This file contains default settings for all hardening scripts
# Override these by setting environment variables before running scripts

# ============================================================================
# SAFETY SETTINGS - CRITICAL FOR REMOTE SERVERS
# ============================================================================

# Safety mode - enables all safety checks (NEVER disable on production)
SAFETY_MODE=1

# Dry run mode - simulate changes without applying them
DRY_RUN=0

# Always backup files before modification
BACKUP_BEFORE_CHANGE=1

# Enable automatic rollback on failure
ROLLBACK_ENABLED=1

# Fail fast - stop on first error
FAIL_FAST=1

# Verbose logging
VERBOSE=0

# ============================================================================
# SSH CONFIGURATION
# ============================================================================

# SSH port (update if using non-standard port)
SSH_PORT=22

# Admin IP address for priority access (set your management IP)
# Example: ADMIN_IP="192.168.1.100"
ADMIN_IP=""

# SSH test port for validation
SSHD_TEST_PORT=2222

# SSH rollback timeout in seconds
SSH_ROLLBACK_TIMEOUT=60

# SSH test timeout in seconds
SSH_TEST_TIMEOUT=10

# Allowed SSH users (space-separated)
# Example: SSH_ALLOW_USERS="admin deploy"
SSH_ALLOW_USERS=""

# Allowed SSH groups (space-separated)
# Example: SSH_ALLOW_GROUPS="sshusers admin"
SSH_ALLOW_GROUPS=""

# ============================================================================
# FIREWALL CONFIGURATION
# ============================================================================

# Enable firewall hardening
ENABLE_FIREWALL=1

# Firewall safety timeout (seconds) - auto-reset if connection lost
FIREWALL_TIMEOUT=300

# Additional ports to allow (space-separated)
# Example: ALLOWED_PORTS="80 443 3306"
ALLOWED_PORTS=""

# Trusted networks (CIDR format, space-separated)
# Example: TRUSTED_NETWORKS="192.168.1.0/24 10.0.0.0/8"
TRUSTED_NETWORKS=""

# ============================================================================
# SYSTEM PATHS
# ============================================================================

# Backup directory
BACKUP_DIR="/var/backups/hardening"

# Log directory
LOG_DIR="/var/log/hardening"

# State directory
STATE_DIR="/var/lib/hardening"

# Backup retention in days
BACKUP_RETENTION_DAYS=30

# ============================================================================
# KERNEL AND SYSTEM HARDENING
# ============================================================================

# Enable kernel hardening
ENABLE_KERNEL_HARDENING=1

# Enable network stack hardening
ENABLE_NETWORK_HARDENING=1

# Enable process limits
ENABLE_PROCESS_LIMITS=1

# Maximum processes per user
MAX_USER_PROCESSES=1024

# Core dump size limit (0 to disable)
CORE_DUMP_LIMIT=0

# ============================================================================
# FILE PERMISSIONS
# ============================================================================

# Enable file permission hardening
ENABLE_FILE_PERMISSIONS=1

# Umask for system files
SYSTEM_UMASK=027

# Umask for user files
USER_UMASK=077

# ============================================================================
# PASSWORD AND AUTHENTICATION
# ============================================================================

# Password minimum length
PASSWORD_MIN_LENGTH=12

# Password maximum age (days)
PASSWORD_MAX_AGE=90

# Password warning age (days)
PASSWORD_WARN_AGE=14

# Account lockout threshold (failed attempts)
ACCOUNT_LOCKOUT_THRESHOLD=5

# Account lockout duration (minutes)
ACCOUNT_LOCKOUT_DURATION=30

# ============================================================================
# LOGGING AND AUDITING
# ============================================================================

# Enable audit logging
ENABLE_AUDIT_LOGGING=1

# Log retention days
LOG_RETENTION_DAYS=90

# Audit log file
AUDIT_LOG="/var/log/audit/audit.log"

# ============================================================================
# SERVICE HARDENING
# ============================================================================

# Services to disable (space-separated)
# Example: DISABLE_SERVICES="bluetooth cups avahi-daemon"
DISABLE_SERVICES=""

# Services to ensure are running (space-separated)
# Example: REQUIRED_SERVICES="ssh fail2ban"
REQUIRED_SERVICES="ssh"

# ============================================================================
# MOUNT OPTIONS
# ============================================================================

# Enable mount hardening
ENABLE_MOUNT_HARDENING=1

# Temporary directories to harden
TMP_DIRS="/tmp /var/tmp /dev/shm"

# Mount options for tmp directories
TMP_MOUNT_OPTIONS="noexec,nosuid,nodev"

# ============================================================================
# SHELL TIMEOUT
# ============================================================================

# Shell timeout in seconds (0 to disable)
SHELL_TIMEOUT=900

# ============================================================================
# INTEGRITY CHECKING
# ============================================================================

# Enable file integrity monitoring
ENABLE_INTEGRITY_CHECK=1

# Directories to monitor for changes
INTEGRITY_DIRS="/etc /bin /sbin /usr/bin /usr/sbin"

# ============================================================================
# EMERGENCY ACCESS
# ============================================================================

# Emergency SSH port (used if main SSH fails)
EMERGENCY_SSH_PORT=2222

# Enable emergency access creation
ENABLE_EMERGENCY_ACCESS=0

# ============================================================================
# TESTING AND VALIDATION
# ============================================================================

# Run validation tests after each script
RUN_VALIDATION=1

# Test mode - extra safety checks
TEST_MODE=0

# ============================================================================
# CUSTOM SETTINGS
# ============================================================================

# Add your custom settings below this line
# They will be preserved during updates